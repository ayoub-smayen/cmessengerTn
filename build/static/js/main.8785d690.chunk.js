(this["webpackJsonpchat-web"]=this["webpackJsonpchat-web"]||[]).push([[0],{121:function(e,t,a){},156:function(e,t,a){e.exports=a.p+"static/media/message.f2f08457.ogg"},177:function(e,t,a){e.exports=a(249)},182:function(e,t,a){},228:function(e,t){},249:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),l=a.n(o),c=(a(182),a(18)),i=(a(121),a(69)),s=a.n(i),u=a(90),m=a(5),d=a(310),p=a(294),f=a(289),E=a(305),b=a(51),g=a(290),v=a(95),O=a.n(v),h=a(72),j=a(287),y=a(288),S=a(66),C=a.n(S),w=a(306),N=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,_=function(){var e=localStorage.getItem("chatUserToken");return e||window.location.reload(!1)},U=function(){return localStorage.getItem("chatUserToken")&&localStorage.removeItem("chatUserToken"),window.location.reload(!1)};function R(e){return r.a.createElement(w.a,Object.assign({elevation:6,variant:"filled"},e))}var x=Object(j.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function k(e){var t=x(),a=Object(n.useState)(""),o=Object(m.a)(a,2),l=o[0],i=o[1],v=Object(n.useState)(""),j=Object(m.a)(v,2),S=j[0],w=j[1],_=Object(n.useState)(""),U=Object(m.a)(_,2),k=U[0],T=U[1],D=Object(n.useState)(""),A=Object(m.a)(D,2),P=A[0],L=A[1],I=Object(n.useState)(""),B=Object(m.a)(I,2),W=B[0],H=B[1],F=Object(n.useState)(""),M=Object(m.a)(F,2),K=M[0],q=M[1],G=Object(n.useState)(""),z=Object(m.a)(G,2),V=z[0],J=z[1],Y=Object(n.useState)(""),Z=Object(m.a)(Y,2),$=Z[0],Q=Z[1],X=Object(n.useState)(""),ee=Object(m.a)(X,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(m.a)(ne,2),oe=re[0],le=re[1],ce=Object(n.useState)(!1),ie=Object(m.a)(ce,2),se=ie[0],ue=ie[1];Object(n.useEffect)((function(){oe&&setTimeout((function(){ue(!0)}),3e3)}),[oe]);var me=function(e){e.preventDefault(),pe()&&de()},de=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.post("/signup",{fullName:l,email:k,password:W});case 3:return 201===e.sent.status&&le(!0),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),t=[],e.t0.response.data?e.t0.response.data.errors?e.t0.response.data.errors.map((function(e,a){t.push(e.msg)})):t.push(e.t0.response.data.message):t.push("Some error occurs, please try again later"),ae(t),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),pe=function(){ae([]),w(""),L(""),q(""),Q("");var e=!1,t=N.test(String(k).toLowerCase());return l||(e=!0,w("Full name input is required!")),k?t||(e=!0,L("Wrong email format!")):(e=!0,L("Email field required!")),W?W!==V?(e=!0,q("Password and password confirmation fields are not equal!")):(W.length<8||V.length<8)&&(e=!0,q("Password and password confirmation fields should have at least 8 characters!")):(e=!0,q("Password field required!")),V||(e=!0,Q("Password confirmation field required!")),!e},fe=r.a.createElement(y.a,{component:"main",maxWidth:"xs"},r.a.createElement(f.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement(d.a,{className:t.avatar},r.a.createElement(O.a,null)),r.a.createElement(h.a,{component:"h1",variant:"h5"},"Sign up"),r.a.createElement("form",{className:t.form,onSubmit:me},r.a.createElement(g.a,{container:!0,spacing:2},r.a.createElement("div",{className:"singup-errors"},S?r.a.createElement(R,{className:"msg alert-msg",severity:"error"},S):null,P?r.a.createElement(R,{className:"msg alert-msg",severity:"error"},P):null,K?r.a.createElement(R,{className:"msg alert-msg",severity:"error"},K):null,$?r.a.createElement(R,{className:"msg alert-msg",severity:"error"},$):null,te.length>0?te.map((function(e,t){return r.a.createElement(R,{key:t,className:"msg alert-msg",severity:"error"},e)})):null),r.a.createElement("div",{className:"singup-success"},oe?r.a.createElement(R,{className:"msg success-msg",severity:"success"},"Registration completed, you will be redirected in login page now..."):null),r.a.createElement(g.a,{item:!0,xs:12},r.a.createElement(E.a,{autoComplete:"fname",name:"firstName",variant:"outlined",required:!0,fullWidth:!0,id:"firstName",label:"Full Name",value:l,autoFocus:!0,onChange:function(e){return i(e.target.value)}})),r.a.createElement(g.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",type:"email",value:k,onChange:function(e){return T(e.target.value)}})),r.a.createElement(g.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",value:W,onChange:function(e){return H(e.target.value)}})),r.a.createElement(g.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"outlined",required:!0,fullWidth:!0,name:"repeat-password",label:"Repeat Password",type:"password",id:"repeat-password",value:V,onChange:function(e){return J(e.target.value)}}))),r.a.createElement(p.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",onClick:me,className:t.submit},"Sign Up"),r.a.createElement(g.a,{container:!0,justify:"flex-end"},r.a.createElement(g.a,{item:!0},r.a.createElement(b.b,{to:"/login",variant:"body2"},"Already have an account? Sign in"))))));return se&&(fe=r.a.createElement(c.a,{to:"/login"})),fe}var T=a(285);function D(e){return r.a.createElement(w.a,Object.assign({elevation:6,variant:"filled"},e))}var A=Object(j.a)((function(e){return{root:{height:"100vh",width:"100%","& > * + *":{marginTop:e.spacing(0)}},image:{backgroundImage:"url(https://source.unsplash.com/random)",backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function P(){var e=A(),t=Object(n.useState)(""),a=Object(m.a)(t,2),o=a[0],l=a[1],c=Object(n.useState)(""),i=Object(m.a)(c,2),v=i[0],j=i[1],y=Object(n.useState)(""),S=Object(m.a)(y,2),w=S[0],_=S[1],U=Object(n.useState)(""),R=Object(m.a)(U,2),x=R[0],k=R[1],P=Object(n.useState)(""),L=Object(m.a)(P,2),I=L[0],B=L[1],W=Object(n.useState)(!1),H=Object(m.a)(W,2),F=H[0],M=H[1],K=Object(n.useState)(!1),q=Object(m.a)(K,2),G=q[0],z=q[1];Object(n.useEffect)((function(){F&&setTimeout((function(){z(!0)}),3e3)}),[F]);var V=function(e){e.preventDefault(),J()&&Y()},J=function(){B([]),j(""),k("");var e=!1,t=N.test(String(o).toLowerCase());return o?t||(e=!0,j("Wrong email format!")):(e=!0,j("Email field required!")),w||(e=!0,k("Password field required!")),!e},Y=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.post("/login",{email:o,password:w});case 3:return 201===(t=e.sent).status&&(M(!0),a=t.data.token,localStorage.setItem("chatUserToken",a)),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),n=[],e.t0.response.data?e.t0.response.data.errors?e.t0.response.data.errors.map((function(e,t){n.push(e.msg)})):n.push(e.t0.response.data.message):n.push("Some error occurs, please try again later"),B(n),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Z=r.a.createElement(g.a,{container:!0,component:"main",className:e.root},r.a.createElement(f.a,null),r.a.createElement(g.a,{item:!0,xs:!1,sm:4,md:7,className:e.image}),r.a.createElement(g.a,{item:!0,xs:12,sm:8,md:5,component:T.a,elevation:6,square:!0},r.a.createElement("div",{className:e.paper},r.a.createElement(d.a,{className:e.avatar},r.a.createElement(O.a,null)),r.a.createElement(h.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:e.form,onSubmit:V},r.a.createElement("div",{className:"login-errors"},v?r.a.createElement(D,{className:"msg alert-msg",severity:"error"},v):null,x?r.a.createElement(D,{className:"msg alert-msg",severity:"error"},x):null,I.length>0?I.map((function(e,t){return r.a.createElement(D,{key:t,className:"msg alert-msg",severity:"error"},e)})):null,F?r.a.createElement(D,{className:"msg success-msg",severity:"success"},"Login completed, you will be redirected to the chat soon"):null),r.a.createElement(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,type:"email",value:o,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){return l(e.target.value)},autoFocus:!0}),r.a.createElement(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",value:w,onChange:function(e){return _(e.target.value)}}),r.a.createElement(p.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",onClick:V,className:e.submit},"Sign In"),r.a.createElement(g.a,{container:!0},r.a.createElement(g.a,{item:!0},r.a.createElement(b.b,{to:"/signup",variant:"body2"},"Don't have an account? Sign Up"))),r.a.createElement(g.a,{container:!0},r.a.createElement(g.a,{item:!0},r.a.createElement("div",{className:"about-cover"},r.a.createElement("a",{href:"https://github.com/huseyn0w/Realtime-Chat",target:"_blank",className:"about-links"},"About the app"),r.a.createElement("a",{href:"https://huseyn0w.github.io",target:"_blank",className:"about-links"},"About the author"))))))));return G&&(Z=window.location.reload(!1)),Z}var L=a(31),I=a(12),B="LOAD_ROOMS",W="NEW_ROOM",H="LEFT_SIDEBAR",F="RIGHT_SIDEBAR",M="CURRENT_ROOM",K="CREATE_ROOM",q="UPDATE_ROOM",G="DELETE_ROOM",z="LOGIN_SUCCESS",V="LOGOUT_CHAT",J="UPDATE_USERS_LIST",Y="UPDATE_CURRENT_USER",Z="UPDATE_CURRENT_USER_IN_USERS_LIST",$="USER_LEFT",Q="USER_DATA_UPDATED",X=function(e,t){switch(t.type){case B:return Object(I.a)(Object(I.a)({},e),{},{rooms:t.payload});case H:return Object(I.a)(Object(I.a)({},e),{},{leftSidebar:t.payload});case F:return Object(I.a)(Object(I.a)({},e),{},{rightSidebar:t.payload});case z:return Object(I.a)(Object(I.a)({},e),{},{logged:!0});case V:return Object(I.a)(Object(I.a)({},e),{},{logged:!1});case M:return Object(I.a)(Object(I.a)({},e),{},{currentRoom:t.payload});case K:var a=Object(L.a)(e.rooms);return-1===a.findIndex((function(e){return e._id===t.payload._id}))?(a.push(t.payload),Object(I.a)(Object(I.a)({},e),{},{rooms:a})):e;case q:var n=Object(L.a)(e.rooms),r=n.findIndex((function(e){return e._id===t.payload._id}));return n[r]=t.payload,Object(I.a)(Object(I.a)({},e),{},{rooms:n});case G:var o=Object(L.a)(e.rooms),l=o.findIndex((function(e){return e._id===t.payload}));return o.splice(l,1),Object(I.a)(Object(I.a)({},e),{},{rooms:o});case J:return Object(I.a)(Object(I.a)({},e),{},{roomUsers:t.payload});case Z:var c=Object(L.a)(e.roomUsers),i=c.findIndex((function(e){return e._id===t.payload._id}));return c[i]=t.payload,Object(I.a)(Object(I.a)({},e),{},{roomUsers:c});case Y:return Object(I.a)(Object(I.a)({},e),{},{currentUser:t.payload});case $:var s=Object(L.a)(e.roomUsers),u=s.findIndex((function(e){return e._id===t.payload}));return s.splice(u,1),Object(I.a)(Object(I.a)({},e),{},{roomUsers:s});case Q:var m=Object(I.a)({},e.currentUser);return m.email=t.payload.email,m.avatar=t.payload.avatar,m.fullName=t.payload.fullName,Object(I.a)(Object(I.a)({},e),{},{currentUser:m});default:return e}},ee={leftSidebar:!0,rightSidebar:!0,logged:!1,activeUsers:[],rooms:[],currentRoom:null,currentUser:{_id:"-",fullName:"-",email:"-"},roomUsers:[],messages:[],error:null},te=Object(n.createContext)(ee),ae=function(e){var t=e.children,a=Object(n.useReducer)(X,ee),o=Object(m.a)(a,2),l=o[0],c=o[1];return r.a.createElement(te.Provider,{value:[l,c]},t)},ne=a(144),re=a.n(ne)()("http://localhost:5000",{"sync disconnect on unload":!0}),oe=a(311),le=a(286),ce=a(145),ie=a.n(ce),se=Object(j.a)((function(e){return{root:{padding:"0",display:"flex",alignItems:"center",width:"100%"},input:{marginLeft:e.spacing(0),flex:1,padding:"0 15px 0 0"},iconButton:{padding:"10 0"},divider:{height:28,margin:4}}}));function ue(e){var t=se();return r.a.createElement(T.a,{component:"div",className:t.root},r.a.createElement(le.a,{type:"submit",className:t.iconButton,"aria-label":"search"},r.a.createElement(ie.a,null)),r.a.createElement(oe.a,{className:t.input,placeholder:e.placeholderText,inputProps:{"aria-label":e.placeholderText},onChange:function(t){var a=t.target.value;e.handler(a)}}))}var me=a(146),de=a(147),pe=a(165),fe=a(164),Ee=a(148),be=function(e){Object(pe.a)(a,e);var t=Object(fe.a)(a);function a(){var e;Object(me.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).scrollbars=r.a.createRef(),e.state={mounted:!1},e}return Object(de.a)(a,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"componentDidUpdate",value:function(){this.props.scrolltobottom&&"1"===this.props.scrolltobottom&&this.state.mounted&&this.scrollbars.current.scrollToBottom()}},{key:"render",value:function(){return r.a.createElement(Ee.Scrollbars,Object.assign({},this.props,{ref:this.scrollbars}))}}]),a}(n.Component),ge=a(312),ve=a(150),Oe=a.n(ve),he=a(151),je=a.n(he),ye=a(152),Se=a.n(ye),Ce=a(97),we=a.n(Ce),Ne=a(309),_e=a(297),Ue=a(296),Re=a(295);function xe(e){var t,a,o=e.open,l=e.headline,c=e.action,i=e.saveHeadline,s=e.currentRoom,u=Object(n.useState)(null!==(t=s.name)&&void 0!==t?t:""),d=Object(m.a)(u,2),f=d[0],b=d[1],g=Object(n.useState)(null!==(a=s.topic)&&void 0!==a?a:""),v=Object(m.a)(g,2),O=v[0],h=v[1],j=Object(n.useState)(""),y=Object(m.a)(j,2),S=y[0],C=y[1],w=function(){e.closeDialog()},N=function(t){t.preventDefault();var a=_();if(f&&O){var n={token:a,room:{name:f,topic:O,password:null!==S&&void 0!==S?S:null}};if("new"===c){n.action="create";var r=f.replace(/[\s#@!%&*()_+="\u0259~\u0401/|<>,.;:?+\\]/g,"-").toLowerCase();n.room.id=r}else n.action="update",n.room._id=s._id;re.emit("roomHandler",n),e.closeDialog()}};return r.a.createElement("div",null,r.a.createElement(Ne.a,{open:o,onClose:w,"aria-labelledby":"form-dialog-title"},r.a.createElement(Re.a,{id:"form-dialog-title"},l),r.a.createElement("form",{onSubmit:N},r.a.createElement(Ue.a,null,r.a.createElement(E.a,{autoFocus:!0,margin:"dense",id:"roomname",label:"Room name",type:"text",value:f,onChange:function(e){return b(e.target.value)},fullWidth:!0}),r.a.createElement(E.a,{id:"roomtopic",label:"Room topic",type:"text",value:O,onChange:function(e){return h(e.target.value)},fullWidth:!0}),r.a.createElement(E.a,{id:"roomPassword",label:"Room password",type:"Password",value:S,onChange:function(e){return C(e.target.value)},fullWidth:!0})),r.a.createElement(_e.a,null,r.a.createElement(p.a,{onClick:w,color:"primary"},"Cancel"),r.a.createElement(p.a,{type:"submit",onClick:N,color:"primary"},i)))))}var ke=a(298);function Te(e){var t=e.open,a=e.currentRoom,o=Object(n.useContext)(te),l=Object(m.a)(o,1)[0];return r.a.createElement("div",null,r.a.createElement(Ne.a,{open:t,onClose:function(){return e.closeDialog()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Re.a,{id:"alert-dialog-title"},"Remove the room"),r.a.createElement(Ue.a,null,r.a.createElement(ke.a,{id:"alert-dialog-description"},'Are you sure? All room members will be transfered to the "Guest room", and room will be removed completely.')),r.a.createElement(_e.a,null,r.a.createElement(p.a,{onClick:function(){return e.closeDialog()},color:"primary"},"Cancel"),r.a.createElement(p.a,{onClick:function(t){var n=_();re.emit("roomHandler",{token:n,room:a,defaultRoom:l.rooms[0]}),e.closeDialog()},color:"primary",autoFocus:!0},"Agree"))))}var De=Object(j.a)((function(e){return{root:{"& > *":{margin:e.spacing(0)}},fab:{margin:e.spacing(0)},absolute:{position:"absolute",bottom:e.spacing(0),right:e.spacing(3)},customButtons:{padding:"0 5px"}}}));var Ae=function(e){var t=De(),a=Object(n.useContext)(te),o=Object(m.a)(a,2),l=o[0],c=o[1],i=Object(n.useState)(!1),s=Object(m.a)(i,2),u=s[0],d=s[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),E=f[0],b=f[1],v=Object(n.useState)(!1),O=Object(m.a)(v,2),h=O[0],j=O[1];return r.a.createElement("div",{className:"leftButtons"},r.a.createElement(g.a,{container:!0,classes:{root:t.root},item:!0,xs:12,spacing:0},r.a.createElement(g.a,{container:!0,classes:{root:t.root},item:!0,xs:10,spacing:0},r.a.createElement(ge.a,{title:"Add room"},r.a.createElement(le.a,{color:"primary",onClick:function(){d(!0)},classes:{root:t.customButtons},"aria-label":"add an alarm"},r.a.createElement(Oe.a,null))),null!==l.currentRoom&&l.currentRoom._id!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_URL:"http://localhost:5000"}).REACT_APP_GUEST_ROOM_ID?r.a.createElement(ge.a,{title:"Rename room"},r.a.createElement(le.a,{color:"primary",onClick:function(){b(!0)},classes:{root:t.customButtons},"aria-label":"add an alarm"},r.a.createElement(je.a,null))):null,null!==l.currentRoom&&l.currentRoom._id!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_URL:"http://localhost:5000"}).REACT_APP_GUEST_ROOM_ID?r.a.createElement(ge.a,{title:"Delete room"},r.a.createElement(le.a,{color:"primary",onClick:function(){j(!0)},classes:{root:t.customButtons},"aria-label":"add an alarm"},r.a.createElement(Se.a,null))):null),r.a.createElement(g.a,{container:!0,classes:{root:t.root},item:!0,xs:2,spacing:0},r.a.createElement(ge.a,{title:"Hide sidebar"},r.a.createElement(le.a,{color:"primary",onClick:function(e){c({type:H,payload:!1})},classes:{root:t.customButtons},"aria-label":"add an alarm"},r.a.createElement(we.a,null))))),r.a.createElement(n.Fragment,null,u?r.a.createElement(xe,{open:!0,closeDialog:function(){return d(!1)},headline:"Create room",saveHeadline:"Save",action:"new",currentRoom:""}):null,E&&null!==l.currentRoom&&l.currentRoom._id!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_URL:"http://localhost:5000"}).REACT_APP_GUEST_ROOM_ID?r.a.createElement(xe,{open:!0,closeDialog:function(){return b(!1)},headline:"Update room",saveHeadline:"Update",action:"update",currentRoom:l.currentRoom}):null,h&&null!==l.currentRoom&&l.currentRoom._id!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_URL:"http://localhost:5000"}).REACT_APP_GUEST_ROOM_ID?r.a.createElement(Te,{open:!0,closeDialog:function(){return j(!1)},currentRoom:l.currentRoom}):null))},Pe=a(293),Le=a(300),Ie=a(302),Be=a(301),We=a(111),He=a.n(We),Fe=a(110),Me=a.n(Fe);function Ke(e){var t,a=e.open,o=e.headline,l=e.saveHeadline,c=e.currentRoom,i=e.authorFullName,s=e.passRoom,u=Object(n.useState)(null!==(t=c.password)&&void 0!==t?t:""),d=Object(m.a)(u,2),f=d[0],b=d[1],g=Object(n.useState)(!1),v=Object(m.a)(g,2),O=v[0],h=v[1];Object(n.useEffect)((function(){j()}),[]);var j=function(){return re.on("room-changed",(function(t){b(""),e.closeDialog()})),re.on("wrongPass",(function(e){b(""),h(!0)})),function(){return re.disconnect()}},y=function(){e.closeDialog()},S=function(e){var t=_();e.preventDefault();var a={passRoom:s,author:i,currentRoom:c,roomPassword:f};re.emit("roomAuthMiddleware",t,a)};return r.a.createElement("div",null,r.a.createElement(Ne.a,{open:a,onClose:y,"aria-labelledby":"form-dialog-title"},r.a.createElement(Re.a,{id:"form-dialog-title"},O?"Wrong password":o),r.a.createElement("form",{onSubmit:S},r.a.createElement(Ue.a,null,r.a.createElement(E.a,{id:"roomPassword",label:"Room password",type:"Password",value:f,onChange:function(e){return b(e.target.value)},fullWidth:!0})),r.a.createElement(_e.a,null,r.a.createElement(p.a,{onClick:y,color:"primary"},"Cancel"),r.a.createElement(p.a,{type:"submit",onClick:S,color:"primary"},l)))))}var qe=a(299),Ge=Object(j.a)((function(e){return{root:{position:"relative"},bottom:{color:e.palette.grey["light"===e.palette.type?200:700],position:"absolute",left:"50%",marginLeft:"-20px"},bottomLeft:{color:e.palette.grey["light"===e.palette.type?200:700],position:"absolute",left:"15px",marginLeft:"0"},top:{color:"#1a90ff",animationDuration:"550ms",position:"absolute",left:"50%",marginLeft:"-20px"},topLeft:{color:"#1a90ff",animationDuration:"550ms",position:"absolute",left:"15px",marginLeft:"0"},circle:{strokeLinecap:"round"}}}));function ze(e){var t=Ge();return r.a.createElement("div",{className:t.root},r.a.createElement(qe.a,Object.assign({variant:"determinate",className:"true"===e.showonleft?t.bottomLeft:t.bottom,size:40,thickness:4},e,{value:100})),r.a.createElement(qe.a,Object.assign({variant:"indeterminate",disableShrink:!0,className:"true"===e.showonleft?t.topLeft:t.top,classes:{circle:t.circle},size:40,thickness:4},e)))}var Ve=Object(j.a)({root:{flexGrow:1}});function Je(e){var t=Ve();return r.a.createElement("div",{className:t.root},r.a.createElement(ze,{showonleft:"true"===e.showonleft?"true":"false"}))}var Ye=Object(j.a)({root:{background:"#EAF5F0",padding:"0 15px"}});var Ze=function(){var e=Object(n.useContext)(te),t=Object(m.a)(e,2),a=t[0],o=t[1],l=Object(n.useState)(a.rooms),c=Object(m.a)(l,2),i=c[0],s=c[1],u=Object(n.useState)([]),d=Object(m.a)(u,2),p=d[0],f=d[1],E=Object(n.useState)(a.currentRoom),b=Object(m.a)(E,2),v=b[0],O=b[1],h=Object(n.useState)(""),j=Object(m.a)(h,2),y=j[0],S=j[1],C=Object(n.useState)(!1),w=Object(m.a)(C,2),N=w[0],R=w[1],x=Ye();Object(n.useEffect)((function(){s((function(e){return a.rooms})),O(a.currentRoom)}),[a.rooms,a.currentRoom]),Object(n.useEffect)((function(){k()}),[]);var k=function(){return re.on("tokenError",U),re.on("joinCompleted",(function(e){e.currentUser&&null!==e.currentUser&&o({type:Y,payload:e.currentUser}),e.roomsList.rooms&&e.roomsList.rooms.length>0&&(o({type:B,payload:e.roomsList.rooms}),e.currentRoom&&null!==e.currentRoom&&o({type:M,payload:e.currentRoom}))})),re.on("newUserArrived",(function(e){e.roomsList.rooms&&e.roomsList.rooms.length>0&&(o({type:B,payload:e.roomsList.rooms}),e.currentRoom&&null!==e.currentRoom&&o({type:M,payload:e.currentRoom}))})),re.on("room-changed",(function(e){o({type:M,payload:e.room})})),re.on("roomCreated",(function(e){o({type:K,payload:e})})),re.on("roomUpdated",(function(e){o({type:q,payload:e})})),re.on("roomDeleted",(function(e){o({type:G,payload:e._id})})),function(){return re.disconnect()}},T=function(e){var t=_();e.protected?(S(e),R(!0)):v._id!==e._id&&re.emit("change-room",t,v,e,a.currentUser.fullName)},D=r.a.createElement("div",{className:"roomsPreloader"},r.a.createElement(Je,null));return i.length>0&&(D=i.map((function(e,t){var a=0,n=0;return i.length>1&&(a=e._id,n=null===v?0:v._id),r.a.createElement(Le.a,{button:!0,key:a,selected:a===n,onClick:function(){return T(e)}},a===n?r.a.createElement(Be.a,null,r.a.createElement(Me.a,null)):null,r.a.createElement(Ie.a,{primary:e.name}),e.protected?r.a.createElement(He.a,null):null)}))),p.length>0&&(D=p.map((function(e){var t=0,a=0;return i.length>1&&(t=e._id,a=null===v?0:v._id),r.a.createElement(Le.a,{button:!0,key:t,selected:t===a,onClick:function(){return T(e)}},t===a?r.a.createElement(Be.a,null,r.a.createElement(Me.a,null)):null,r.a.createElement(Ie.a,{primary:e.name}),e.protected?r.a.createElement(He.a,null):null)}))),r.a.createElement(g.a,{container:!0,classes:{root:x.root},item:!0,xs:12,spacing:0},N?r.a.createElement(Ke,{open:!0,currentRoom:v,passRoom:y,authorFullName:a.currentUser.fullName,closeDialog:function(){return R(!1)},headline:"Enter password",saveHeadline:"Save",action:"new"}):null,r.a.createElement("div",{className:"leftSearch"},r.a.createElement(ue,{handler:function(e){if(e){var t=i.filter((function(t,a){return t.name.toLowerCase().search(e.toLowerCase())>-1}));t.length>0&&f(t)}else f([])},placeholderText:"Filter room names"})),r.a.createElement(be,{autoHide:!0,style:{width:"100%",height:"75vh"}},r.a.createElement("div",{className:"leftRooms"},r.a.createElement(Pe.a,{component:"nav","aria-label":"rooms-list"},D))),r.a.createElement(Ae,null))},$e=a(153),Qe=a.n($e),Xe=a(154),et=a.n(Xe);function tt(e){var t=e.open,a=Object(n.useContext)(te),o=Object(m.a)(a,2),l=o[0],c=o[1];return r.a.createElement("div",null,r.a.createElement(Ne.a,{open:t,onClose:function(){return e.closeDialog()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Re.a,{id:"alert-dialog-title"},"Exit the chat"),r.a.createElement(Ue.a,null,r.a.createElement(ke.a,{id:"alert-dialog-description"},"Are you sure you want to leave the chat?")),r.a.createElement(_e.a,null,r.a.createElement(p.a,{onClick:function(){return e.closeDialog()},color:"primary"},"Stay"),r.a.createElement(p.a,{onClick:function(t){var a=_(),n=l.currentUser.fullName;re.emit("userExited",{token:a,room:l.currentRoom._id,fullName:n}),localStorage.removeItem("chatUserToken"),c({type:V}),e.closeDialog(),window.location.reload(!1)},color:"primary"},"Exit"))))}function at(e){var t,a,o,l=e.open,c=Object(n.useContext)(te),i=Object(m.a)(c,2),s=i[0],u=i[1],d=Object(n.useState)(null!==(t=s.currentUser.fullName)&&void 0!==t?t:""),f=Object(m.a)(d,2),b=f[0],g=f[1],v=Object(n.useState)(null!==(a=s.currentUser.email)&&void 0!==a?a:""),O=Object(m.a)(v,2),h=O[0],j=O[1],y=Object(n.useState)(null!==(o=s.currentUser.avatar)&&void 0!==o?o:""),S=Object(m.a)(y,2),C=S[0],w=S[1],N=Object(n.useState)(""),U=Object(m.a)(N,2),R=U[0],x=U[1],k=Object(n.useState)(!1),T=Object(m.a)(k,2),D=T[0],A=T[1];Object(n.useEffect)((function(){P()}),[]),Object(n.useEffect)((function(){g(s.currentUser.fullName),j(s.currentUser.email),w(s.currentUser.avatar)}),[s.currentUser]);var P=function(){return re.on("userUpdateSuccess",(function(t){u({type:Q,payload:t}),u({type:Z,payload:t}),e.closeDialog(),A(!1)})),re.on("roomUserUpdated",(function(t){u({type:Q,payload:t}),u({type:Z,payload:t}),e.closeDialog(),A(!1)})),function(){return re.disconnect()}},L=function(){e.closeDialog()},I=function(e){e.preventDefault();var t=_();re.emit("updateUserData",{token:t,fullName:b,email:h,newPassword:R,avatar:C}),A(!0)};return r.a.createElement("div",null,r.a.createElement(Ne.a,{open:l,onClose:L,"aria-labelledby":"form-dialog-title"},r.a.createElement(Re.a,{id:"form-dialog-title"},"Edit profile details"),D?r.a.createElement(Je,null):null,r.a.createElement("form",{onSubmit:I},r.a.createElement(Ue.a,null,r.a.createElement(E.a,{id:"roomtopic",label:"Full Name",type:"text",value:b,onChange:function(e){return g(e.target.value)},fullWidth:!0,className:"profile-input-item"}),r.a.createElement(E.a,{id:"avatar",label:"Avatar URL",type:"text",value:C,onChange:function(e){return w(e.target.value)},fullWidth:!0,className:"profile-input-item"}),r.a.createElement(E.a,{id:"roomtopic",label:"Email",type:"email",value:h,onChange:function(e){return j(e.target.value)},fullWidth:!0,className:"profile-input-item"}),r.a.createElement(E.a,{id:"password",label:"New password",type:"password",value:R,onChange:function(e){return x(e.target.value)},fullWidth:!0})),r.a.createElement(_e.a,null,r.a.createElement(p.a,{onClick:L,color:"primary"},"Cancel"),r.a.createElement(p.a,{type:"submit",onClick:I,color:"primary"},"Save")))))}var nt=Object(j.a)((function(e){return{root:{"& > *":{margin:e.spacing(0)}},fab:{margin:e.spacing(0)},absolute:{position:"absolute",bottom:e.spacing(0),right:e.spacing(3)},customButtons:{padding:"0 5px"}}}));var rt=function(){var e=nt(),t=Object(n.useContext)(te),a=Object(m.a)(t,2),o=(a[0],a[1]),l=Object(n.useState)(!1),c=Object(m.a)(l,2),i=c[0],s=c[1],u=Object(n.useState)({id:"-",fullname:"-",email:"-",status:"-",avatar:null}),d=Object(m.a)(u,1)[0],p=Object(n.useState)(!1),f=Object(m.a)(p,2),E=f[0],b=f[1];return r.a.createElement("div",{className:"rightButtons"},r.a.createElement(at,{userData:d,open:E,closeDialog:function(){return b(!1)}}),r.a.createElement(g.a,{container:!0,classes:{root:e.root},item:!0,xs:12,spacing:0},r.a.createElement(g.a,{container:!0,classes:{root:e.root},item:!0,xs:10,spacing:0},r.a.createElement(ge.a,{title:"Profile"},r.a.createElement(le.a,{color:"primary",onClick:function(){b(!0)},classes:{root:e.customButtons},"aria-label":"add an alarm"},r.a.createElement(Qe.a,null))),r.a.createElement(ge.a,{title:"Exit"},r.a.createElement(le.a,{color:"primary",onClick:function(){return s(!0)},classes:{root:e.customButtons},"aria-label":"add an alarm"},r.a.createElement(et.a,null)))),r.a.createElement(g.a,{container:!0,classes:{root:e.root},item:!0,xs:2,spacing:0},r.a.createElement(ge.a,{title:"Hide sidebar"},r.a.createElement(le.a,{color:"primary",onClick:function(e){o({type:F,payload:!1})},classes:{root:e.customButtons},"aria-label":"add an alarm"},r.a.createElement(we.a,null))))),r.a.createElement(n.Fragment,null,i?r.a.createElement(tt,{open:!0,closeDialog:function(){return s(!1)}}):null))},ot=a(303);function lt(e){var t=e.userData,a=e.openBox,o=e.currentUser,l=e.currentRoom,c=Object(n.useState)(!1),i=Object(m.a)(c,2),s=i[0],u=i[1];Object(n.useEffect)((function(){f()}),[]);var f=function(){re.on("userBanCompleted",(function(t){u(!1),e.onClose()}))},E=function(){e.onClose()};return r.a.createElement(Ne.a,{open:a||!1,onClose:E,"aria-labelledby":"form-dialog-title"},r.a.createElement(Re.a,{id:"form-dialog-title"},"User info"),r.a.createElement(Ue.a,null,r.a.createElement(d.a,{alt:t.avatar,src:t.avatar,className:"userInfoAvatar"}),r.a.createElement("p",null,"Fullname: ",t.fullName),r.a.createElement("p",null,"Email: ",t.email),r.a.createElement("p",null,"Status: ",t.status)),s?r.a.createElement(Je,{showonleft:"true"}):null,r.a.createElement(_e.a,null,r.a.createElement(p.a,{onClick:E,color:"primary"},"Close"),"Admin"===o.status&&t._id!==o._id?r.a.createElement(p.a,{onClick:function(){return e=t._id,u(!0),void re.emit("banUser",e,l._id);var e},color:"primary"},"Ban"):null))}function ct(){var e=r.a.useState(!0),t=Object(m.a)(e,1)[0];return r.a.createElement("div",null,r.a.createElement(Ne.a,{open:t,onClose:function(){},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Re.a,{id:"alert-dialog-title"},"ALERT!"),r.a.createElement(Ue.a,null,r.a.createElement(ke.a,{id:"alert-dialog-description"},"Unfortunately you have benn banned from the chat. Please contact administrator to get more details. You will be redirected to the home page now."))))}var it=Object(j.a)({table:{minWidth:650},chatSection:{width:"100%",paddingTop:"5px"},headBG:{backgroundColor:"#e0e0e0"},borderRight500:{borderRight:"1px solid #e0e0e0"},messageArea:{height:"70vh",overflowY:"hidden"}}),st=function(){var e=it(),t=Object(n.useContext)(te),a=Object(m.a)(t,2),o=a[0],l=a[1],c=Object(n.useState)(o.roomUsers),i=Object(m.a)(c,2),s=i[0],u=i[1],p=Object(n.useState)([]),f=Object(m.a)(p,2),b=f[0],v=f[1],O=Object(n.useState)("-"),h=Object(m.a)(O,2),j=h[0],y=h[1],S=Object(n.useState)(null),C=Object(m.a)(S,2),w=C[0],N=C[1],R=Object(n.useState)({_id:"-",fullName:"-",email:"-",status:"-"}),x=Object(m.a)(R,2),k=x[0],D=x[1],A=Object(n.useState)(!1),P=Object(m.a)(A,2),L=P[0],I=P[1],B=Object(n.useState)(!1),W=Object(m.a)(B,2),H=W[0],F=W[1];window.onbeforeunload=function(){var e=_();re.emit("userExited",{room:o.currentRoom._id,token:e,fullName:o.currentUser.fullName})},Object(n.useEffect)((function(){w!==j||H||M()}),[w,j]),Object(n.useEffect)((function(){u((function(e){return o.roomUsers}))}),[o.roomUsers]),Object(n.useEffect)((function(){K()}),[]),Object(n.useEffect)((function(){D((function(e){return o.currentUser}))}),[o.currentUser]);var M=function(){F(!0),setTimeout((function(){U()}),5e3)},K=function(){re.on("newUserArrived",(function(e){e.roomUsers&&l({type:J,payload:e.roomUsers})})),re.on("joinCompleted",(function(e){e.currentUser&&(e.currentUser.banned&&M(),N(e.currentUser._id),l({type:Y,payload:e.currentUser})),e.roomUsers&&l({type:J,payload:e.roomUsers})})),re.on("userGone",(function(e){l({type:$,payload:e})})),re.on("user-left-room",(function(e){e.roomUsers&&l({type:J,payload:e.roomUsers})})),re.on("userLeft",(function(e){e.roomUsers&&l({type:J,payload:e.roomUsers})})),re.on("room-changed",(function(e){e.roomUsers&&l({type:J,payload:e.roomUsers})})),re.on("room-changed-rest",(function(e){e.roomUsers&&l({type:J,payload:e.roomUsers})})),re.on("userBanCompleted",(function(e){y(e.userID),e.currentRoomUsers&&l({type:J,payload:e.currentRoomUsers})}))},q=function(e){var t=s.filter((function(t,a){return t._id===e}));t.length>0&&(D(t[0]),I(!0))},G=r.a.createElement("div",{className:"roomsPreloader"},r.a.createElement(Je,null));return s.length>0&&(G=s.map((function(e,t){return r.a.createElement(Le.a,{button:!0,key:e._id,id:e._id,onClick:function(){return q(e._id)}},r.a.createElement(Be.a,null,r.a.createElement(d.a,{alt:e.fullName,src:e.avatar})),r.a.createElement(Ie.a,{primary:e.fullName},e.fullName))}))),b.length>0&&(G=b.map((function(e,t){return r.a.createElement(Le.a,{button:!0,key:e._id,id:e._id,onClick:function(){return q(e._id)}},r.a.createElement(Be.a,null,r.a.createElement(d.a,{alt:e.fullName,src:e.avatar})),r.a.createElement(Ie.a,{primary:e.fullName},e.fullName))}))),r.a.createElement("div",null,H?r.a.createElement(ct,null):null,r.a.createElement(lt,{userData:k,currentUser:o.currentUser,currentRoom:o.currentRoom,openBox:L,onClose:function(){return I(!1)}}),r.a.createElement(g.a,{container:!0,component:T.a,className:e.chatSection},r.a.createElement(g.a,{item:!0,xs:12,className:e.borderRight500},r.a.createElement(g.a,{item:!0,xs:12,style:{padding:"10px"}},r.a.createElement(E.a,{id:"outlined-basic-email",onChange:function(e){var t=e.target.value;if(t){var a=s.filter((function(e,a){return e.fullName.toLowerCase().search(t.toLowerCase())>-1}));a.length>0&&v(a)}else v([])},label:"Search user in room",variant:"outlined",fullWidth:!0})),r.a.createElement(ot.a,null),r.a.createElement(be,{autoHide:!0,style:{width:"100%",height:"78vh"}},r.a.createElement(Pe.a,null,G)))))},ut=Object(j.a)({root:{background:"#fff"}});var mt=function(){var e=ut();return r.a.createElement(g.a,{container:!0,classes:{root:e.root},item:!0,xs:12,spacing:0},r.a.createElement("div",{className:"right-sidebar"},r.a.createElement(rt,null),r.a.createElement(st,null)))},dt=a(304),pt=a(155),ft=a.n(pt);function Et(e){var t,a=e.data,n=a.message,o=a.attachment,l=a.avatar,c=a.sender,i=e.direction,s=ft()().format("LT"),u=null;return o&&(u=r.a.createElement("div",null,r.a.createElement("a",{href:"/server/images/"+o,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:"/server/images/"+o,alt:"Message Attachment",className:"messageItemAttachment"})))),t="left"===i?r.a.createElement(dt.a,{direction:"right",in:!0,mountOnEnter:!0,unmountOnExit:!0},r.a.createElement(Le.a,{align:"left",style:{padding:0,marginBottom:15}},"System"!==c?r.a.createElement(Be.a,null,r.a.createElement(d.a,{alt:"User avatar",src:l})):null,r.a.createElement(Ie.a,{align:"left",className:"messageItemTextCover"},r.a.createElement("p",{className:"messageHeadline"},c+" - "+s),u?r.a.createElement("p",null,u):null,n?r.a.createElement("p",{className:"messageItemFrom"},r.a.createElement("span",null,n)):null))):"center"===i?r.a.createElement(dt.a,{direction:"down",in:!0,mountOnEnter:!0,unmountOnExit:!0},r.a.createElement(Le.a,{align:"center",style:{padding:0,marginBottom:15}},"System"!==c?r.a.createElement(Be.a,null,r.a.createElement(d.a,{alt:"User avatar",src:l})):null,r.a.createElement(Ie.a,{align:"center",className:"messageItemTextCover"},r.a.createElement("p",{className:""},c+" - "+s),u?r.a.createElement("p",null,u):null,n?r.a.createElement("p",null,r.a.createElement("span",null,n)):null))):r.a.createElement(dt.a,{direction:"left",in:!0,mountOnEnter:!0,unmountOnExit:!0},r.a.createElement(Le.a,{align:"right",style:{padding:0,marginBottom:15}},r.a.createElement(Ie.a,{align:"right",className:"messageItemTextCover messageTo"},r.a.createElement("p",{className:"messageHeadline"},c+" - "+s),u?r.a.createElement("div",null,u):null,n?r.a.createElement("p",{className:"messageItemTo"},r.a.createElement("span",null,n)):null),r.a.createElement(Be.a,{style:{justifyContent:"flex-end"}},r.a.createElement(d.a,{alt:"User avatar",src:l})))),r.a.createElement(Le.a,{style:{padding:0}},r.a.createElement(g.a,{container:!0,style:{padding:0}},r.a.createElement(g.a,{item:!0,xs:12},r.a.createElement(Pe.a,null,t))))}var bt=a(156),gt=a.n(bt),vt=function(e){return r.a.createElement("div",{className:"follow-wrapper"},r.a.createElement("ul",{className:"bg-bubbles"},r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null),r.a.createElement("li",null)))};var Ot=function(){var e=Object(n.useContext)(te),t=Object(m.a)(e,2),a=t[0],o=t[1],l=Object(n.useState)(new Audio(gt.a)),c=Object(m.a)(l,1)[0],i=Object(n.useState)([]),s=Object(m.a)(i,2),u=s[0],d=s[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),E=f[0],b=f[1],g=Object(n.useState)(null),v=Object(m.a)(g,2),O=v[0],h=v[1];Object(n.useEffect)((function(){E?c.play():(c.pause(),c.currentTime=0),setTimeout((function(){b(!1)}),3e3)}),[E]),Object(n.useEffect)((function(){j()}),[]);var j=function(){return re.on("joinCompleted",(function(e){o({type:Y,payload:e.currentUser}),d((function(t){return[].concat(Object(L.a)(t),[e])}))})),re.on("newUserArrived",(function(e){b(!0),d((function(t){return[].concat(Object(L.a)(t),[e])}))})),re.on("room-changed",(function(e){d((function(t){return[e.message]})),o({type:W,payload:e.room})})),re.on("room-changed-rest",(function(e){d((function(t){return[].concat(Object(L.a)(t),[e.message])})),o({type:W,payload:e.room}),e.roomUsers&&o({type:J,payload:e.roomUsers})})),re.on("newMsgSaved",(function(e){h(e.message),d((function(t){return t.length>1e3?[e]:[].concat(Object(L.a)(t),[e])}))})),re.on("user-left-room",(function(e){d((function(t){return[].concat(Object(L.a)(t),[e.message])}))})),re.on("userLeft",(function(e){d((function(t){return[].concat(Object(L.a)(t),[e.message])})),o({type:J,payload:e.currentRoomUsers})})),re.on("userExit",(function(e){d((function(t){return[].concat(Object(L.a)(t),[e])}))})),function(){return re.disconnect()}};return O&&O.indexOf(a.currentUser.fullName)>-1&&!E&&(b(!0),h(null),setTimeout((function(){b(!1)}),3e3)),r.a.createElement(be,{autoHide:!0,scrolltobottom:"1",renderTrackHorizontal:function(e){return r.a.createElement("div",Object.assign({},e,{className:"track-horizontal",style:{display:"none"}}))},renderThumbHorizontal:function(e){return r.a.createElement("div",Object.assign({},e,{className:"thumb-horizontal",style:{display:"none"}}))},renderView:function(e){return r.a.createElement("div",{style:Object(I.a)({padding:"0 25px 0 15px"},e.style)})},style:{width:"100%",height:"90vh"}},r.a.createElement(Pe.a,null,u.length>5?r.a.createElement(vt,null):null,u.length>0?u.map((function(e,t){var n=a.roomUsers.findIndex((function(t){return t._id===e.user})),o=null;n>-1&&(o=a.roomUsers[n].avatar),e.avatar=o;var l="left";return"system"===e.type?l="center":"current"===e.type&&(l="right"),r.a.createElement(Et,{key:t,data:e,direction:l})})):null))},ht=a(160),jt=a.n(ht),yt=a(158),St=a.n(yt),Ct=(a(247),a(163)),wt=a(159),Nt=a.n(wt),_t=a(308),Ut=a(157),Rt=a.n(Ut),xt=Object(j.a)((function(e){return{close:{padding:e.spacing(.5)}}}));function kt(e){var t,a=r.a.useState(!0),n=Object(m.a)(a,2),o=n[0],l=n[1],c=r.a.useState(null!==(t=e.message)&&void 0!==t?t:"salam"),i=Object(m.a)(c,2),s=i[0],u=i[1],d=function(e,t){"clickaway"!==t&&l(!1)},p=xt();return r.a.createElement("div",null,r.a.createElement(_t.a,{key:"message-notification-key",anchorOrigin:{vertical:"bottom",horizontal:"left"},open:o,autoHideDuration:6e3,onClose:d,onExited:function(){u(void 0)},message:s||"salam",action:r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{"aria-label":"close",color:"inherit",className:p.close,onClick:d},r.a.createElement(Rt.a,null)))}))}var Tt=Object(j.a)((function(e){return{button:{margin:e.spacing(1)},messageForm:{width:"100%"},root:{position:"relative",padding:"0 20px",width:"100%"},input:{display:"none"}}}));var Dt=function(e){var t=Tt(),a=Object(n.useState)(""),o=Object(m.a)(a,2),l=o[0],c=o[1],i=Object(n.useState)(""),s=Object(m.a)(i,2),u=s[0],d=s[1],f=Object(n.useState)(""),b=Object(m.a)(f,2),v=b[0],O=b[1],h=Object(n.useState)(!1),j=Object(m.a)(h,2),y=j[0],S=j[1],w=Object(n.useRef)(null),N=Object(n.useContext)(te),_=Object(m.a)(N,1)[0],U=Object(n.useState)(_.roomUsers),R=Object(m.a)(U,2),x=R[0],k=R[1],T=Object(n.useState)([]),D=Object(m.a)(T,2),A=D[0],P=D[1],L=Object(n.useState)(!1),I=Object(m.a)(L,2),B=I[0],W=I[1],H=Object(n.useState)({show:!1,message:""}),F=Object(m.a)(H,2),M=F[0],K=F[1];Object(n.useEffect)((function(){k((function(e){return _.roomUsers}))}),[_.roomUsers]);var q=function(t){if(t.preventDefault(),l||v){var a={text:l,attachment:null};if(v){var n=new FormData;n.append("file",u);C.a.post("http://localhost:5000/upload",n).then((function(t){200===t.status&&(a.attachment=t.data.filename,e.onSend(a),c(""),O(""),d(""))})).catch((function(e){var t=null;t=e.response.data?e.response.data.message:"Some error ocurred, please try again later",K({show:!0,message:t}),setTimeout((function(){K({show:!1,message:!1})}),3e3)}))}else e.onSend(a),c(""),O(""),d("")}},G=function(e){var t=l.lastIndexOf("@"),a=l.slice(0,t+1);c(a+e+" "),w.current.focus(),W(!1)},z=null;return x.length>0&&(z=x.map((function(e,t){return r.a.createElement("li",{key:e._id,onClick:function(){return G(e.fullName)}},e.fullName)}))),A.length>0&&(z=A.map((function(e,t){return r.a.createElement("li",{key:e._id,onClick:function(){return G(e.fullName)}},e.fullName)}))),r.a.createElement("form",{className:t.messageForm,onSubmit:q,noValidate:!0,autoComplete:"off"},M.show?r.a.createElement(kt,{message:M.message}):null,r.a.createElement(g.a,{container:!0,item:!0,xs:12,classes:{root:t.root},spacing:0},r.a.createElement("div",{className:"attachment_cover"},v?r.a.createElement(r.a.Fragment,null,r.a.createElement(St.a,{className:"remove-attachment",onClick:function(e){O(""),d("")}}),r.a.createElement("img",{src:v,className:"attachment-preview",alt:"preview"})):null),y?r.a.createElement("div",{className:"emoji_cover"},r.a.createElement(Ct.a,{set:"google",showPreview:!1,showSkinTones:!1,onSelect:function(e){var t=e.unified.split("-"),a=[];t.forEach((function(e){return a.push("0x"+e)}));var n=String.fromCodePoint.apply(String,a);c((function(e){return e+" "+n})),S(!1),w.current.focus()},style:{position:"absolute",bottom:"60px",right:"20px"}})):null,r.a.createElement(g.a,{container:!0,item:!0,xs:9,spacing:0},B?r.a.createElement("ul",{className:"suggestionsList"},z):null,r.a.createElement(E.a,{id:"standard-basic",inputRef:w,value:l,onChange:function(e){var t=e.target.value,a=t[t.length-1];" "===a&&W(!1),"@"!==a||B||W(!0);var n=t.lastIndexOf("@");if(n>-1){var r=t.slice(n+1);if(r){var o=x.filter((function(e,t){return e.fullName.toLowerCase().search(r.toLowerCase())>-1}));o.length>0&&P(o)}else P([])}c(t)},className:"messageInput",label:"Message"})),r.a.createElement(g.a,{container:!0,item:!0,xs:3,spacing:0},r.a.createElement("input",{accept:"image/*",onChange:function(e){return function(e){e.preventDefault();var t=e.target.files[0];if(t){e.target.value="";var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(e){O(a.result),d(t)}}}(e)},className:t.input,id:"icon-button-file",type:"file"}),r.a.createElement(le.a,{color:"primary",className:t.button,"aria-label":"Add emoji",onClick:function(){return S(!y)}},r.a.createElement(Nt.a,null)),r.a.createElement(p.a,{color:"primary",className:t.button,onClick:q},r.a.createElement(jt.a,null,"Send")))))},At=Object(j.a)((function(e){return{button:{margin:e.spacing(1)},root:{padding:"0"}}}));function Pt(e){var t=At(),a=Object(n.useContext)(te),o=Object(m.a)(a,1)[0];return r.a.createElement(g.a,{container:!0,item:!0,xs:12,classes:{root:t.root},spacing:0},r.a.createElement(Ot,null),r.a.createElement(Dt,{onSend:function(e){var t=_(),a={room:o.currentRoom,msg:e,user:o.currentUser.fullName,avatar:o.currentUser.avatar};re.emit("newMsg",t,a)}}))}var Lt=a(161),It=a.n(Lt),Bt=a(162),Wt=a.n(Bt),Ht=Object(j.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary}}}));function Ft(){var e=_(),t=Ht(),a=Object(n.useContext)(te),o=Object(m.a)(a,2),l=o[0],c=o[1],i=Object(n.useState)(!1),s=Object(m.a)(i,2),u=s[0],d=s[1];Object(n.useEffect)((function(){re.emit("newUser",e)}),[]),Object(n.useEffect)((function(){p()}),[]);var p=function(){re.on("userUpdateSuccess",(function(e){d(!0),setTimeout((function(){d(!1)}),3e3)}))},f=8,E=2,b=2;return l.leftSidebar||l.rightSidebar?l.leftSidebar&&l.rightSidebar||(f=9,l.leftSidebar?(E=2,b=1):(E=1,b=2)):(f=10,E=1,b=1),r.a.createElement("div",{className:t.root},u?r.a.createElement(kt,{message:"User data updated"}):null,r.a.createElement(g.a,{container:!0,spacing:0,className:"MessageFrameCover"},r.a.createElement(g.a,{container:!0,item:!0,xs:E,spacing:0},l.leftSidebar?r.a.createElement(Ze,null):r.a.createElement(It.a,{color:"primary",className:"leftSidebarButton",onClick:function(){return c({type:H,payload:!0})}})),r.a.createElement(g.a,{container:!0,item:!0,xs:f,spacing:0},r.a.createElement(Pt,null)),r.a.createElement(g.a,{container:!0,item:!0,xs:b,spacing:0},l.rightSidebar?r.a.createElement(mt,null):r.a.createElement(Wt.a,{className:"rightSidebarButton",onClick:function(){return c({type:F,payload:!0})}}))))}var Mt=function(){var e=localStorage.getItem("chatUserToken");return r.a.createElement(c.d,null,r.a.createElement(c.b,{path:"/login",exact:!0},e?r.a.createElement(ae,null,r.a.createElement(Ft,null)):r.a.createElement(P,null)),r.a.createElement(c.b,{path:"/signup",exact:!0},e?r.a.createElement(ae,null,r.a.createElement(Ft,null)):r.a.createElement(k,null)),r.a.createElement(c.b,{path:"/"},r.a.createElement(ae,null,e?r.a.createElement(Ft,null):r.a.createElement(P,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement(Mt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[177,1,2]]]);
//# sourceMappingURL=main.8785d690.chunk.js.map